{"ast":null,"code":"import _objectSpread from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import FuseScrollbars from'@fuse/core/FuseScrollbars';import{yupResolver}from'@hookform/resolvers/yup';import{Controller,useForm}from'react-hook-form';import _ from'@lodash';import Button from'@mui/material/Button';import Fab from'@mui/material/Fab';import IconButton from'@mui/material/IconButton';import Input from'@mui/material/Input';import Tooltip from'@mui/material/Tooltip';import Typography from'@mui/material/Typography';import{useEffect,useState}from'react';import{useParams}from'react-router-dom';import withRouter from'@fuse/core/withRouter';import FuseSvgIcon from'@fuse/core/FuseSvgIcon';import*as yup from'yup';import format from'date-fns/format';import{useDispatch}from'react-redux';import NoteFormList from'./tasks/NoteFormList';import NoteFormLabelMenu from'./NoteFormLabelMenu';import NoteFormReminder from'./NoteFormReminder';import NoteFormUploadImage from'./NoteFormUploadImage';import NoteModel from'../model/NoteModel';import NoteReminderLabel from'../NoteReminderLabel';import NoteLabel from'../NoteLabel';/**\r\n * Form Validation Schema\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var schema=yup.object().shape({title:yup.string(),content:yup.string(),image:yup.string(),tasks:yup.array(),oneOfThemRequired:yup.bool().when(['title','content','image','tasks'],{is:function is(a,b,c,d){return!a&&!b&&!c&&!d||!!a&&!!b&&!!c&&!!d;},then:yup.bool().required(''),otherwise:yup.bool()})});function NoteForm(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showList=_useState2[0],setShowList=_useState2[1];var routeParams=useParams();var dispatch=useDispatch();var defaultValues=_.merge({},NoteModel(),props.note,routeParams.labelId?{labels:[routeParams.labelId]}:null,routeParams.id==='archive'?{archived:true}:null);var _useForm=useForm({mode:'onChange',defaultValues:defaultValues,resolver:yupResolver(schema)}),formState=_useForm.formState,handleSubmit=_useForm.handleSubmit,getValues=_useForm.getValues,reset=_useForm.reset,watch=_useForm.watch,setValue=_useForm.setValue,control=_useForm.control;var isValid=formState.isValid,dirtyFields=formState.dirtyFields,errors=formState.errors;var noteForm=watch();/**\r\n   * Update Note\r\n   */useEffect(function(){if(!props.note||props.variant==='new'||!props.onChange){return;}if(!_.isEqual(props.note,noteForm)){props.onChange(noteForm);}},[noteForm,props,defaultValues]);function handleRemoveLabel(id){setValue(\"labels\",noteForm.labels.filter(function(_id){return _id!==id;}));}/**\r\n   * Create New Note\r\n   */function onCreate(data){if(!props.onCreate){return;}props.onCreate(data);}return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full\",children:[/*#__PURE__*/_jsx(FuseScrollbars,{className:\"flex flex-auto w-full max-h-640\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(Controller,{name:\"image\",control:control,defaultValue:\"\",render:function render(_ref){var _ref$field=_ref.field,onChange=_ref$field.onChange,value=_ref$field.value;if(!value||value===''){return null;}return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:value,className:\"w-full block\",alt:\"note\"}),/*#__PURE__*/_jsx(Fab,{className:\"absolute right-0 bottom-0 m-8\",variant:\"extended\",size:\"small\",color:\"secondary\",\"aria-label\":\"Delete Image\",type:\"button\",onClick:function onClick(){return onChange('');},children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:trash\"})})]});}}),/*#__PURE__*/_jsx(\"div\",{className:\"px-20 my-16\",children:/*#__PURE__*/_jsx(Controller,{name:\"title\",control:control,render:function render(_ref2){var field=_ref2.field;return/*#__PURE__*/_jsx(Input,_objectSpread(_objectSpread({},field),{},{className:\"font-semibold text-14\",placeholder:\"Title\",type:\"text\",disableUnderline:true,fullWidth:true}));}})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-20 my-16\",children:/*#__PURE__*/_jsx(Controller,{name:\"content\",control:control,render:function render(_ref3){var field=_ref3.field;return/*#__PURE__*/_jsx(Input,_objectSpread(_objectSpread({},field),{},{placeholder:\"Take a note...\",multiline:true,rows:\"4\",disableUnderline:true,fullWidth:true}));}})}),/*#__PURE__*/_jsx(Controller,{name:\"tasks\",control:control,defaultValue:[],render:function render(_ref4){var _ref4$field=_ref4.field,onChange=_ref4$field.onChange,value=_ref4$field.value;if((value===null||value===void 0?void 0:value.length)===0&&!showList||!value&&!showList){return null;}return/*#__PURE__*/_jsx(\"div\",{className:\"px-16\",children:/*#__PURE__*/_jsx(NoteFormList,{tasks:value||[],onCheckListChange:function onCheckListChange(val){return onChange(val);}})});}}),(noteForm.labels||noteForm.reminder||noteForm.createdAt)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap w-full px-20 my-16 -mx-4\",children:[noteForm.reminder&&/*#__PURE__*/_jsx(NoteReminderLabel,{className:\"mt-4 mx-4\",date:noteForm.reminder,onDelete:function onDelete(){setValue('reminder',null);}}),/*#__PURE__*/_jsx(Controller,{name:\"labels\",control:control,defaultValue:[],render:function render(_ref5){var _ref5$field=_ref5.field,onChange=_ref5$field.onChange,value=_ref5$field.value;if(!value){return null;}return value.map(function(id){return/*#__PURE__*/_jsx(NoteLabel,{id:id,className:\"mt-4 mx-4\",onDelete:function onDelete(){return onChange(value.filter(function(_id){return _id!==id;}));}},id);});}}),noteForm.createdAt&&/*#__PURE__*/_jsxs(Typography,{color:\"text.secondary\",className:\"text-12 mt-8 mx-4\",children:[\"Edited: \",format(new Date(noteForm.createdAt),'MMM dd yy, h:mm')]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-auto justify-between items-center px-16 pb-12\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Remind me\",placement:\"bottom\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Controller,{name:\"reminder\",control:control,defaultValue:[],render:function render(_ref6){var _ref6$field=_ref6.field,_onChange=_ref6$field.onChange,value=_ref6$field.value;return/*#__PURE__*/_jsx(NoteFormReminder,{reminder:value,onChange:function onChange(val){return _onChange(val);}});}})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Add image\",placement:\"bottom\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(NoteFormUploadImage,{onChange:function onChange(val){return setValue('image',val,{shouldDirty:true,shouldValidate:true});}})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Add tasks\",placement:\"bottom\",children:/*#__PURE__*/_jsx(IconButton,{className:\"w-32 h-32 mx-4 p-0\",onClick:function onClick(){return setShowList(!showList);},size:\"large\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:pencil-alt\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Change labels\",placement:\"bottom\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(NoteFormLabelMenu,{note:noteForm,onChange:function onChange(labels){return setValue('labels',labels);}})})}),/*#__PURE__*/_jsx(Controller,{name:\"archived\",control:control,defaultValue:false,render:function render(_ref7){var _ref7$field=_ref7.field,onChange=_ref7$field.onChange,value=_ref7$field.value;return/*#__PURE__*/_jsx(Tooltip,{title:value?'Unarchive':'Archive',placement:\"bottom\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(IconButton,{className:\"w-32 h-32 mx-4 p-0\"// disabled={newFormButtonDisabled()}\n,onClick:function onClick(){onChange(!value);if(props.variant==='new'){setTimeout(function(){return onCreate(getValues());});}},size:\"large\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:value?'heroicons-solid:archive':'heroicons-outline:archive'})})})});}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center\",children:props.variant==='new'?/*#__PURE__*/_jsx(Button,{className:\"m-4 p-8\",type:\"submit\",variant:\"contained\",color:\"secondary\",size:\"small\",onClick:handleSubmit(onCreate),disabled:_.isEmpty(dirtyFields)||!isValid,children:\"Create\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Delete Note\",placement:\"bottom\",children:/*#__PURE__*/_jsx(IconButton,{className:\"w-32 h-32 mx-4 p-0\",onClick:props.onRemove,size:\"large\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:trash\"})})}),/*#__PURE__*/_jsx(Button,{className:\"m-4\",onClick:props.onClose,variant:\"default\",children:\"Close\"})]})})]})]});}NoteForm.defaultProps={variant:'edit',note:null};export default withRouter(NoteForm);","map":null,"metadata":{},"sourceType":"module"}