{"ast":null,"code":"import _objectSpread from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import Button from'@mui/material/Button';import NavLinkAdapter from'@fuse/core/NavLinkAdapter';import{useDispatch,useSelector}from'react-redux';import{useNavigate,useParams}from'react-router-dom';import{useEffect}from'react';import FuseLoading from'@fuse/core/FuseLoading';import _ from'@lodash';import*as yup from'yup';import{Controller,useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup/dist/yup';import Box from'@mui/system/Box';import FuseSvgIcon from'@fuse/core/FuseSvgIcon';import TextField from'@mui/material/TextField';import InputAdornment from'@mui/material/InputAdornment';import Autocomplete from'@mui/material/Autocomplete/Autocomplete';import Checkbox from'@mui/material/Checkbox/Checkbox';import DateTimePicker from'@mui/lab/DateTimePicker';import IconButton from'@mui/material/IconButton';import{useDeepCompareEffect}from'@fuse/hooks';import TaskPrioritySelector from'./TaskPrioritySelector';import FormActionsMenu from'./FormActionsMenu';import{addTask,getTask,newTask,selectTask,updateTask}from'../store/taskSlice';import{selectTags}from'../store/tagsSlice';/**\r\n * Form Validation Schema\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var schema=yup.object().shape({title:yup.string().required('You must enter a name')});var TaskForm=function TaskForm(props){var task=useSelector(selectTask);var tags=useSelector(selectTags);var routeParams=useParams();var dispatch=useDispatch();var navigate=useNavigate();var _useForm=useForm({mode:'onChange',resolver:yupResolver(schema)}),control=_useForm.control,watch=_useForm.watch,reset=_useForm.reset,handleSubmit=_useForm.handleSubmit,formState=_useForm.formState,getValues=_useForm.getValues;var isValid=formState.isValid,dirtyFields=formState.dirtyFields,errors=formState.errors;var form=watch();/**\r\n   * Update Task\r\n   */useDeepCompareEffect(function(){if(!isValid||_.isEmpty(form)||!task||routeParams.id==='new'){return;}if(!_.isEqual(task,form)){onSubmit(form);}},[form,isValid]);useEffect(function(){if(routeParams.id==='new'){dispatch(newTask(routeParams.type));}else{dispatch(getTask(routeParams.id));}},[dispatch,routeParams]);useEffect(function(){reset(_objectSpread({},task));},[task,reset]);/**\r\n   * Form Submit\r\n   */function onSubmit(data){dispatch(updateTask(data));}function onSubmitNew(data){dispatch(addTask(data)).then(function(_ref){var payload=_ref.payload;navigate(\"/apps/tasks/\".concat(payload.id));});}if(_.isEmpty(form)||!task){return/*#__PURE__*/_jsx(FuseLoading,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex flex-col flex-auto items-center px-24 sm:px-48\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between border-b-1 w-full py-24 mt-16 mb-32\",children:[/*#__PURE__*/_jsx(Controller,{control:control,name:\"completed\",render:function render(_ref2){var _ref2$field=_ref2.field,value=_ref2$field.value,onChange=_ref2$field.onChange;return/*#__PURE__*/_jsxs(Button,{className:\"font-semibold\",onClick:function onClick(){return onChange(!value);},children:[/*#__PURE__*/_jsx(Box,{sx:{color:value?'secondary.main':'text.disabled'},children:/*#__PURE__*/_jsx(FuseSvgIcon,{children:\"heroicons-outline:check-circle\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"mx-8\",children:task.completed?'MARK AS INCOMPLETE':'MARK AS COMPLETE'})]});}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[routeParams.id!=='new'&&/*#__PURE__*/_jsx(FormActionsMenu,{taskId:task.id}),/*#__PURE__*/_jsx(IconButton,{className:\"\",component:NavLinkAdapter,to:\"/apps/tasks\",size:\"large\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{children:\"heroicons-outline:x\"})})]})]}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"title\",render:function render(_ref3){var _errors$title;var field=_ref3.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:\"mt-32 max-h-auto\"},field),{},{label:\"\".concat(_.upperFirst(form.type),\" title\"),placeholder:\"Job title\",id:\"title\",error:!!errors.title,helperText:errors===null||errors===void 0?void 0:(_errors$title=errors.title)===null||_errors$title===void 0?void 0:_errors$title.message,variant:\"outlined\",fullWidth:true,multiline:true,minRows:3,maxRows:10}));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"tags\",render:function render(_ref4){var _ref4$field=_ref4.field,_onChange=_ref4$field.onChange,value=_ref4$field.value;return/*#__PURE__*/_jsx(Autocomplete,{multiple:true,id:\"tags\",className:\"mt-32\",options:tags,disableCloseOnSelect:true,getOptionLabel:function getOptionLabel(option){return option.title;},renderOption:function renderOption(_props,option,_ref5){var selected=_ref5.selected;return/*#__PURE__*/_jsxs(\"li\",_objectSpread(_objectSpread({},_props),{},{children:[/*#__PURE__*/_jsx(Checkbox,{style:{marginRight:8},checked:selected}),option.title]}));},value:value?value.map(function(id){return _.find(tags,{id:id});}):[],onChange:function onChange(event,newValue){_onChange(newValue.map(function(item){return item.id;}));},fullWidth:true,renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Tags\",placeholder:\"Tags\"}));}});}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full space-x-16 mt-32 mb-16 items-center\",children:[/*#__PURE__*/_jsx(Controller,{control:control,name:\"priority\",render:function render(_ref6){var field=_ref6.field;return/*#__PURE__*/_jsx(TaskPrioritySelector,_objectSpread({},field));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"dueDate\",render:function render(_ref7){var field=_ref7.field;return/*#__PURE__*/_jsx(DateTimePicker,_objectSpread(_objectSpread({},field),{},{className:\"w-full\",clearable:true,showTodayButton:true,renderInput:function renderInput(_props){return/*#__PURE__*/_jsx(TextField,_objectSpread({className:\"\",id:\"due-date\",label:\"Due date\",type:\"date\",InputLabelProps:{shrink:true},variant:\"outlined\",fullWidth:true},_props));}}));}})]}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"notes\",render:function render(_ref8){var _errors$notes;var field=_ref8.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:\"mt-32\"},field),{},{label:\"Notes\",placeholder:\"Notes\",id:\"notes\",error:!!errors.notes,helperText:errors===null||errors===void 0?void 0:(_errors$notes=errors.notes)===null||_errors$notes===void 0?void 0:_errors$notes.message,variant:\"outlined\",fullWidth:true,multiline:true,minRows:5,maxRows:10,InputProps:{className:'max-h-min h-min items-start',startAdornment:/*#__PURE__*/_jsx(InputAdornment,{className:\"mt-16\",position:\"start\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-solid:menu-alt-2\"})})}}));}})]}),routeParams.id==='new'&&/*#__PURE__*/_jsxs(Box,{className:\"flex items-center mt-40 py-14 pr-16 pl-4 sm:pr-48 sm:pl-36 border-t\",sx:{backgroundColor:'background.default'},children:[/*#__PURE__*/_jsx(Button,{className:\"ml-auto\",component:NavLinkAdapter,to:-1,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{className:\"ml-8\",variant:\"contained\",color:\"secondary\",disabled:_.isEmpty(dirtyFields)||!isValid,onClick:handleSubmit(onSubmitNew),children:\"Create\"})]})]});};export default TaskForm;","map":null,"metadata":{},"sourceType":"module"}