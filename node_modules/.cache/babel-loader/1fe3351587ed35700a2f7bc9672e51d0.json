{"ast":null,"code":"\"use strict\";\n\nvar _createForOfIteratorHelper = require(\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RemoveUnusedComponents = void 0;\n\nvar utils_1 = require(\"../../utils\");\n\nvar RemoveUnusedComponents = function RemoveUnusedComponents() {\n  var components = new Map();\n\n  function registerComponent(location, componentType, name) {\n    var _a;\n\n    components.set(location.absolutePointer, {\n      used: ((_a = components.get(location.absolutePointer)) === null || _a === void 0 ? void 0 : _a.used) || false,\n      componentType: componentType,\n      name: name\n    });\n  }\n\n  return {\n    ref: {\n      leave: function leave(ref, _ref) {\n        var type = _ref.type,\n            resolve = _ref.resolve,\n            key = _ref.key;\n\n        if (['Schema', 'Parameter', 'Response', 'SecurityScheme'].includes(type.name)) {\n          var resolvedRef = resolve(ref);\n          if (!resolvedRef.location) return;\n          components.set(resolvedRef.location.absolutePointer, {\n            used: true,\n            name: key.toString()\n          });\n        }\n      }\n    },\n    DefinitionRoot: {\n      leave: function leave(root, ctx) {\n        var data = ctx.getVisitorData();\n        data.removedCount = 0;\n        var rootComponents = new Set();\n        components.forEach(function (usageInfo) {\n          var used = usageInfo.used,\n              name = usageInfo.name,\n              componentType = usageInfo.componentType;\n\n          if (!used && componentType) {\n            rootComponents.add(componentType);\n            delete root[componentType][name];\n            data.removedCount++;\n          }\n        });\n\n        var _iterator = _createForOfIteratorHelper(rootComponents),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var component = _step.value;\n\n            if (utils_1.isEmptyObject(root[component])) {\n              delete root[component];\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    },\n    NamedSchemas: {\n      Schema: function Schema(schema, _ref2) {\n        var location = _ref2.location,\n            key = _ref2.key;\n\n        if (!schema.allOf) {\n          registerComponent(location, 'definitions', key.toString());\n        }\n      }\n    },\n    NamedParameters: {\n      Parameter: function Parameter(_parameter, _ref3) {\n        var location = _ref3.location,\n            key = _ref3.key;\n        registerComponent(location, 'parameters', key.toString());\n      }\n    },\n    NamedResponses: {\n      Response: function Response(_response, _ref4) {\n        var location = _ref4.location,\n            key = _ref4.key;\n        registerComponent(location, 'responses', key.toString());\n      }\n    },\n    NamedSecuritySchemes: {\n      SecurityScheme: function SecurityScheme(_securityScheme, _ref5) {\n        var location = _ref5.location,\n            key = _ref5.key;\n        registerComponent(location, 'securityDefinitions', key.toString());\n      }\n    }\n  };\n};\n\nexports.RemoveUnusedComponents = RemoveUnusedComponents;","map":null,"metadata":{},"sourceType":"script"}