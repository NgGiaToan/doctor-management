{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\giato\\\\Downloads\\\\Workspace\\\\.Net\\\\api\\\\doctor-management-fe\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import Button from'@mui/material/Button';import NavLinkAdapter from'@fuse/core/NavLinkAdapter';import{useDispatch,useSelector}from'react-redux';import{useNavigate,useParams}from'react-router-dom';import{useEffect}from'react';import FuseLoading from'@fuse/core/FuseLoading';import _ from'@lodash';import*as yup from'yup';import{Controller,useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup/dist/yup';import Box from'@mui/system/Box';import FuseSvgIcon from'@fuse/core/FuseSvgIcon';import Avatar from'@mui/material/Avatar';import TextField from'@mui/material/TextField';import InputAdornment from'@mui/material/InputAdornment';import IconButton from'@mui/material/IconButton';import Autocomplete from'@mui/material/Autocomplete/Autocomplete';import Checkbox from'@mui/material/Checkbox/Checkbox';import DateTimePicker from'@mui/lab/DateTimePicker';import{addContact,getContact,newContact,removeContact,selectContact,updateContact}from'../store/contactSlice';import{selectCountries}from'../store/countriesSlice';import{selectTags}from'../store/tagsSlice';import ContactEmailSelector from'./email-selector/ContactEmailSelector';import PhoneNumberSelector from'./phone-number-selector/PhoneNumberSelector';/**\r\n * Form Validation Schema\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var schema=yup.object().shape({name:yup.string().required('You must enter a name')});var ContactForm=function ContactForm(props){var contact=useSelector(selectContact);var countries=useSelector(selectCountries);var tags=useSelector(selectTags);var routeParams=useParams();var dispatch=useDispatch();var navigate=useNavigate();var _useForm=useForm({mode:'onChange',resolver:yupResolver(schema)}),control=_useForm.control,watch=_useForm.watch,reset=_useForm.reset,handleSubmit=_useForm.handleSubmit,formState=_useForm.formState,getValues=_useForm.getValues;var isValid=formState.isValid,dirtyFields=formState.dirtyFields,errors=formState.errors;var form=watch();useEffect(function(){if(routeParams.id==='new'){dispatch(newContact());}else{dispatch(getContact(routeParams.id));}},[dispatch,routeParams]);useEffect(function(){reset(_objectSpread({},contact));},[contact,reset]);function getCountryByIso(iso){return countries.find(function(country){return country.iso===iso;});}/**\r\n   * Form Submit\r\n   */function onSubmit(data){if(routeParams.id==='new'){dispatch(addContact(data)).then(function(_ref){var payload=_ref.payload;navigate(\"/apps/contacts/\".concat(payload.id));});}else{dispatch(updateContact(data));}}function handleRemoveContact(){dispatch(removeContact(contact.id)).then(function(){navigate('/apps/contacts');});}if(_.isEmpty(form)||!contact){return/*#__PURE__*/_jsx(FuseLoading,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Box,{className:\"relative w-full h-160 sm:h-192 px-32 sm:px-48\",sx:{backgroundColor:'background.default'},children:contact.background&&/*#__PURE__*/_jsx(\"img\",{className:\"absolute inset-0 object-cover w-full h-full\",src:contact.background,alt:\"user background\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative flex flex-col flex-auto items-center px-24 sm:px-48\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-auto items-end -mt-64\",children:/*#__PURE__*/_jsx(Controller,{control:control,name:\"avatar\",render:function render(_ref2){var _ref2$field=_ref2.field,onChange=_ref2$field.onChange,value=_ref2$field.value;return/*#__PURE__*/_jsxs(Box,{sx:{borderWidth:4,borderStyle:'solid',borderColor:'background.paper'},className:\"relative flex items-center justify-center w-128 h-128 rounded-full overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-black bg-opacity-50 z-10\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 flex items-center justify-center z-20\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"button-avatar\",className:\"flex p-8 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",className:\"hidden\",id:\"button-avatar\",type:\"file\",onChange:/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var readFileAsync,newImage;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:readFileAsync=function _readFileAsync(){return new Promise(function(resolve,reject){var file=e.target.files[0];if(!file){return;}var reader=new FileReader();reader.onload=function(){resolve(\"data:\".concat(file.type,\";base64,\").concat(btoa(reader.result)));};reader.onerror=reject;reader.readAsBinaryString(file);});};_context.next=3;return readFileAsync();case 3:newImage=_context.sent;onChange(newImage);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref3.apply(this,arguments);};}()}),/*#__PURE__*/_jsx(FuseSvgIcon,{className:\"text-white\",children:\"heroicons-outline:camera\"})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){onChange('');},children:/*#__PURE__*/_jsx(FuseSvgIcon,{className:\"text-white\",children:\"heroicons-solid:trash\"})})})]}),/*#__PURE__*/_jsx(Avatar,{sx:{backgroundColor:'background.default',color:'text.secondary'},className:\"object-cover w-full h-full text-64 font-bold\",src:value,alt:contact.name,children:contact.name.charAt(0)})]});}})})}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"name\",render:function render(_ref4){var _errors$name;var field=_ref4.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:\"mt-32\"},field),{},{label:\"Name\",placeholder:\"Name\",id:\"name\",error:!!errors.name,helperText:errors===null||errors===void 0?void 0:(_errors$name=errors.name)===null||_errors$name===void 0?void 0:_errors$name.message,variant:\"outlined\",required:true,fullWidth:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-solid:user-circle\"})})}}));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"tags\",render:function render(_ref5){var _ref5$field=_ref5.field,_onChange=_ref5$field.onChange,value=_ref5$field.value;return/*#__PURE__*/_jsx(Autocomplete,{multiple:true,id:\"tags\",className:\"mt-32\",options:tags,disableCloseOnSelect:true,getOptionLabel:function getOptionLabel(option){return option.title;},renderOption:function renderOption(_props,option,_ref6){var selected=_ref6.selected;return/*#__PURE__*/_jsxs(\"li\",_objectSpread(_objectSpread({},_props),{},{children:[/*#__PURE__*/_jsx(Checkbox,{style:{marginRight:8},checked:selected}),option.title]}));},value:value?value.map(function(id){return _.find(tags,{id:id});}):[],onChange:function onChange(event,newValue){_onChange(newValue.map(function(item){return item.id;}));},fullWidth:true,renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Tags\",placeholder:\"Tags\"}));}});}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"title\",render:function render(_ref7){var _errors$title;var field=_ref7.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:\"mt-32\"},field),{},{label:\"Title\",placeholder:\"Job title\",id:\"title\",error:!!errors.title,helperText:errors===null||errors===void 0?void 0:(_errors$title=errors.title)===null||_errors$title===void 0?void 0:_errors$title.message,variant:\"outlined\",fullWidth:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-solid:briefcase\"})})}}));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"company\",render:function render(_ref8){var _errors$company;var field=_ref8.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:\"mt-32\"},field),{},{label:\"Company\",placeholder:\"Company\",id:\"company\",error:!!errors.company,helperText:errors===null||errors===void 0?void 0:(_errors$company=errors.company)===null||_errors$company===void 0?void 0:_errors$company.message,variant:\"outlined\",fullWidth:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-solid:office-building\"})})}}));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"emails\",render:function render(_ref9){var field=_ref9.field;return/*#__PURE__*/_jsx(ContactEmailSelector,_objectSpread({className:\"mt-32\"},field));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"phoneNumbers\",render:function render(_ref10){var field=_ref10.field;return/*#__PURE__*/_jsx(PhoneNumberSelector,_objectSpread({className:\"mt-32\"},field));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"address\",render:function render(_ref11){var _errors$address;var field=_ref11.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:\"mt-32\"},field),{},{label:\"Address\",placeholder:\"Address\",id:\"address\",error:!!errors.address,helperText:errors===null||errors===void 0?void 0:(_errors$address=errors.address)===null||_errors$address===void 0?void 0:_errors$address.message,variant:\"outlined\",fullWidth:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-solid:location-marker\"})})}}));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"birthday\",render:function render(_ref12){var field=_ref12.field;return/*#__PURE__*/_jsx(DateTimePicker,_objectSpread(_objectSpread({},field),{},{className:\"mt-8 mb-16 w-full\",clearable:true,showTodayButton:true,renderInput:function renderInput(_props){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},_props),{},{className:\"mt-32\",id:\"birthday\",label:\"Birthday\",type:\"date\",InputLabelProps:{shrink:true},variant:\"outlined\",fullWidth:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-solid:cake\"})})}}));}}));}}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"notes\",render:function render(_ref13){var _errors$notes;var field=_ref13.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:\"mt-32\"},field),{},{label:\"Notes\",placeholder:\"Notes\",id:\"notes\",error:!!errors.notes,helperText:errors===null||errors===void 0?void 0:(_errors$notes=errors.notes)===null||_errors$notes===void 0?void 0:_errors$notes.message,variant:\"outlined\",fullWidth:true,multiline:true,minRows:5,maxRows:10,InputProps:{className:'max-h-min h-min items-start',startAdornment:/*#__PURE__*/_jsx(InputAdornment,{className:\"mt-16\",position:\"start\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-solid:menu-alt-2\"})})}}));}})]}),/*#__PURE__*/_jsxs(Box,{className:\"flex items-center mt-40 py-14 pr-16 pl-4 sm:pr-48 sm:pl-36 border-t\",sx:{backgroundColor:'background.default'},children:[routeParams.id!=='new'&&/*#__PURE__*/_jsx(Button,{color:\"error\",onClick:handleRemoveContact,children:\"Delete\"}),/*#__PURE__*/_jsx(Button,{className:\"ml-auto\",component:NavLinkAdapter,to:-1,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{className:\"ml-8\",variant:\"contained\",color:\"secondary\",disabled:_.isEmpty(dirtyFields)||!isValid,onClick:handleSubmit(onSubmit),children:\"Save\"})]})]});};export default ContactForm;","map":null,"metadata":{},"sourceType":"module"}