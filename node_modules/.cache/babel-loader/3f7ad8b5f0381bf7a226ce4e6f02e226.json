{"ast":null,"code":"import _slicedToArray from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import FuseScrollbars from'@fuse/core/FuseScrollbars';import{styled}from'@mui/material/styles';import IconButton from'@mui/material/IconButton';import Paper from'@mui/material/Paper';import Typography from'@mui/material/Typography';import clsx from'clsx';import formatDistanceToNow from'date-fns/formatDistanceToNow';import{useEffect,useMemo,useRef,useState}from'react';import{useDispatch,useSelector}from'react-redux';import InputBase from'@mui/material/InputBase';import FuseSvgIcon from'@fuse/core/FuseSvgIcon';import{selectSelectedContactId}from'./store/contactsSlice';import{selectChat,sendMessage}from'./store/chatSlice';import{selectUser}from'./store/userSlice';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StyledMessageRow=styled('div')(function(_ref){var theme=_ref.theme;return{'&.contact':{'& .bubble':{backgroundColor:theme.palette.secondary.light,color:theme.palette.secondary.contrastText,borderTopLeftRadius:5,borderBottomLeftRadius:5,borderTopRightRadius:20,borderBottomRightRadius:20,'& .time':{marginLeft:12}},'&.first-of-group':{'& .bubble':{borderTopLeftRadius:20}},'&.last-of-group':{'& .bubble':{borderBottomLeftRadius:20}}},'&.me':{paddingLeft:40,'& .bubble':{marginLeft:'auto',backgroundColor:theme.palette.primary.light,color:theme.palette.primary.contrastText,borderTopLeftRadius:20,borderBottomLeftRadius:20,borderTopRightRadius:5,borderBottomRightRadius:5,'& .time':{justifyContent:'flex-end',right:0,marginRight:12}},'&.first-of-group':{'& .bubble':{borderTopRightRadius:20}},'&.last-of-group':{'& .bubble':{borderBottomRightRadius:20}}},'&.contact + .me, &.me + .contact':{paddingTop:20,marginTop:20},'&.first-of-group':{'& .bubble':{borderTopLeftRadius:20,paddingTop:13}},'&.last-of-group':{'& .bubble':{borderBottomLeftRadius:20,paddingBottom:13,'& .time':{display:'flex'}}}};});function Chat(props){var dispatch=useDispatch();var selectedContactId=useSelector(selectSelectedContactId);var chat=useSelector(selectChat);var user=useSelector(selectUser);var chatScroll=useRef(null);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),messageText=_useState2[0],setMessageText=_useState2[1];useEffect(function(){scrollToBottom();},[chat]);function scrollToBottom(){if(!chatScroll.current){return;}chatScroll.current.scrollTo({top:chatScroll.current.scrollHeight,behavior:'smooth'});}var onInputChange=function onInputChange(ev){setMessageText(ev.target.value);};return/*#__PURE__*/_jsxs(Paper,{className:clsx('flex flex-col relative pb-64 shadow',props.className),sx:{background:function background(theme){return theme.palette.background.default;}},children:[/*#__PURE__*/_jsxs(FuseScrollbars,{ref:chatScroll,className:\"flex flex-1 flex-col overflow-y-auto overscroll-contain\",option:{suppressScrollX:true,wheelPropagation:false},children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col pt-16\",children:useMemo(function(){function isFirstMessageOfGroup(item,i){return i===0||chat[i-1]&&chat[i-1].contactId!==item.contactId;}function isLastMessageOfGroup(item,i){return i===chat.length-1||chat[i+1]&&chat[i+1].contactId!==item.contactId;}return(chat===null||chat===void 0?void 0:chat.length)>0?chat.map(function(item,i){return/*#__PURE__*/_jsx(StyledMessageRow,{className:clsx('flex flex-col grow-0 shrink-0 items-start justify-end relative px-16 pb-4',item.contactId===user.id?'me':'contact',{'first-of-group':isFirstMessageOfGroup(item,i)},{'last-of-group':isLastMessageOfGroup(item,i)},i+1===chat.length&&'pb-72'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"bubble flex relative items-center justify-center p-12 max-w-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"leading-tight whitespace-pre-wrap\",children:item.value}),/*#__PURE__*/_jsx(Typography,{className:\"time absolute hidden w-full text-11 mt-8 -mb-24 ltr:left-0 rtl:right-0 bottom-0 whitespace-nowrap\",color:\"text.secondary\",children:formatDistanceToNow(new Date(item.createdAt),{addSuffix:true})})]})},i);}):null;},[chat,user===null||user===void 0?void 0:user.id])}),(chat===null||chat===void 0?void 0:chat.length)===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col flex-1 items-center justify-center\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{size:128,color:\"disabled\",children:\"heroicons-outline:chat\"})}),/*#__PURE__*/_jsx(Typography,{className:\"px-16 pb-24 text-center\",color:\"text.secondary\",children:\"Start a conversation by typing your message below.\"})]})]}),useMemo(function(){var onMessageSubmit=function onMessageSubmit(ev){ev.preventDefault();if(messageText===''){return;}dispatch(sendMessage({messageText:messageText,chatId:chat.id,contactId:selectedContactId})).then(function(){setMessageText('');});};return/*#__PURE__*/_jsx(_Fragment,{children:chat&&/*#__PURE__*/_jsx(\"form\",{onSubmit:onMessageSubmit,className:\"pb-16 px-8 absolute bottom-0 left-0 right-0\",children:/*#__PURE__*/_jsxs(Paper,{className:\"rounded-24 flex items-center relative shadow\",children:[/*#__PURE__*/_jsx(InputBase,{autoFocus:false,id:\"message-input\",className:\"flex flex-1 grow shrink-0 mx-16 ltr:mr-48 rtl:ml-48 my-8\",placeholder:\"Type your message\",onChange:onInputChange,value:messageText}),/*#__PURE__*/_jsx(IconButton,{className:\"absolute ltr:right-0 rtl:left-0 top-0\",type:\"submit\",size:\"large\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{className:\"rotate-90\",color:\"action\",children:\"heroicons-outline:paper-airplane\"})})]})})});},[chat,dispatch,messageText,selectedContactId])]});}export default Chat;","map":null,"metadata":{},"sourceType":"module"}