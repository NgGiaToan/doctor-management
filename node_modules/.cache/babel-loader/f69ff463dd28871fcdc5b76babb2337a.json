{"ast":null,"code":"import _toConsumableArray from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useDebounce}from'@fuse/hooks';import _ from'@lodash';import{DateTimePicker}from'@mui/lab';import clsx from'clsx';import Avatar from'@mui/material/Avatar';import Chip from'@mui/material/Chip';import DialogContent from'@mui/material/DialogContent';import IconButton from'@mui/material/IconButton';import InputAdornment from'@mui/material/InputAdornment';import List from'@mui/material/List';import TextField from'@mui/material/TextField';import Tooltip from'@mui/material/Tooltip';import Typography from'@mui/material/Typography';import Autocomplete from'@mui/material/Autocomplete';import fromUnixTime from'date-fns/fromUnixTime';import getUnixTime from'date-fns/getUnixTime';import format from'date-fns/format';import{Controller,useForm}from'react-hook-form';import{useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import FuseSvgIcon from'@fuse/core/FuseSvgIcon';import{Box}from'@mui/system';import{closeCardDialog,removeCard,selectCardData,updateCard}from'../../../store/cardSlice';import CardActivity from'./activity/CardActivity';import CardAttachment from'./attachment/CardAttachment';import CardChecklist from'./checklist/CardChecklist';import CardComment from'./comment/CardComment';import{selectListById}from'../../../store/listsSlice';import{selectLabels}from'../../../store/labelsSlice';import{selectBoard}from'../../../store/boardSlice';import{selectMembers}from'../../../store/membersSlice';import DueMenu from'./toolbar/DueMenu';import LabelsMenu from'./toolbar/LabelsMenu';import MembersMenu from'./toolbar/MembersMenu';import CheckListMenu from'./toolbar/CheckListMenu';import OptionsMenu from'./toolbar/OptionsMenu';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function BoardCardForm(props){var dispatch=useDispatch();var board=useSelector(selectBoard);var labels=useSelector(selectLabels);var members=useSelector(selectMembers);var card=useSelector(selectCardData);var list=useSelector(function(state){return selectListById(state,card===null||card===void 0?void 0:card.listId);});var _useForm=useForm({mode:'onChange',defaultValues:card}),register=_useForm.register,watch=_useForm.watch,control=_useForm.control,setValue=_useForm.setValue;var cardForm=watch();var updateCardData=useDebounce(function(newCard){dispatch(updateCard(newCard));},600);useEffect(function(){if(!card){return;}if(!_.isEqual(card,cardForm)){updateCardData(cardForm);}},[card,cardForm,updateCardData]);useEffect(function(){register('attachmentCoverId');},[register]);if(!card){return null;}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(DialogContent,{className:\"flex flex-col sm:flex-row p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-auto flex-col py-16 px-0 sm:px-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:justify-between justify-center items-center mb-24\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-16 sm:mb-0 flex items-center\",children:[/*#__PURE__*/_jsx(Typography,{children:board.title}),/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:chevron-right\"}),/*#__PURE__*/_jsx(Typography,{children:list&&list.title})]}),cardForm.dueDate&&/*#__PURE__*/_jsx(DateTimePicker,{value:format(fromUnixTime(cardForm.dueDate),'Pp'),inputFormat:\"Pp\",onChange:function onChange(val){return setValue('dueDate',getUnixTime(val));},renderInput:function renderInput(_props){return/*#__PURE__*/_jsx(TextField,_objectSpread({label:\"Due date\",placeholder:\"Choose a due date\",className:\"w-full sm:w-auto\"},_props));}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center mb-24\",children:/*#__PURE__*/_jsx(Controller,{name:\"title\",control:control,render:function render(_ref){var field=_ref.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},field),{},{label:\"Title\",type:\"text\",variant:\"outlined\",fullWidth:true,required:true,InputProps:{endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:card.subscribed&&/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,color:\"action\",children:\"heroicons-outline:eye\"})})}}));}})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full mb-24\",children:/*#__PURE__*/_jsx(Controller,{name:\"description\",control:control,render:function render(_ref2){var field=_ref2.field;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},field),{},{label:\"Description\",multiline:true,rows:\"4\",variant:\"outlined\",fullWidth:true}));}})}),cardForm.labels&&cardForm.labels.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 mb-24 mx-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-16 mb-12\",children:[/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:tag\"}),/*#__PURE__*/_jsx(Typography,{className:\"font-semibold text-16 mx-8\",children:\"Labels\"})]}),/*#__PURE__*/_jsx(Autocomplete,{className:\"mt-8 mb-16\",multiple:true,freeSolo:true,options:labels,getOptionLabel:function getOptionLabel(label){return label.title;},value:cardForm.labels.map(function(id){return _.find(labels,{id:id});}),onChange:function onChange(event,newValue){setValue('labels',newValue.map(function(item){return item.id;}));},renderTags:function renderTags(value,getTagProps){return value.map(function(option,index){return/*#__PURE__*/_jsx(Chip,_objectSpread(_objectSpread({label:option.title},getTagProps({index:index})),{},{className:\"m-3\"}));});},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{placeholder:\"Select multiple Labels\",label:\"Labels\",variant:\"outlined\",InputLabelProps:{shrink:true}}));}})]}),cardForm.memberIds&&cardForm.memberIds.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 mb-24 mx-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-16 mb-12\",children:[/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:users\"}),/*#__PURE__*/_jsx(Typography,{className:\"font-semibold text-16 mx-8\",children:\"Members\"})]}),/*#__PURE__*/_jsx(Autocomplete,{className:\"mt-8 mb-16\",multiple:true,freeSolo:true,options:members,getOptionLabel:function getOptionLabel(member){return member.name;},value:cardForm.memberIds.map(function(id){return _.find(members,{id:id});}),onChange:function onChange(event,newValue){setValue('memberIds',newValue.map(function(item){return item.id;}));},renderTags:function renderTags(value,getTagProps){return value.map(function(option,index){return/*#__PURE__*/_jsx(Chip,_objectSpread(_objectSpread({label:option.name},getTagProps({index:index})),{},{className:clsx('m-3',option.class),avatar:/*#__PURE__*/_jsx(Tooltip,{title:option.name,children:/*#__PURE__*/_jsx(Avatar,{src:option.avatar})})}));});},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{placeholder:\"Select multiple Members\",label:\"Members\",variant:\"outlined\",InputLabelProps:{shrink:true}}));}})]}),cardForm.attachments&&cardForm.attachments.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-24\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-16 mb-12\",children:[/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:paper-clip\"}),/*#__PURE__*/_jsx(Typography,{className:\"font-semibold text-16 mx-8\",children:\"Attachments\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col sm:flex-row flex-wrap -mx-16\",children:cardForm.attachments.map(function(item){return/*#__PURE__*/_jsx(CardAttachment,{item:item,card:cardForm,makeCover:function makeCover(){setValue('attachmentCoverId',item.id);},removeCover:function removeCover(){setValue('attachmentCoverId','');},removeAttachment:function removeAttachment(){setValue('attachments',_.reject(cardForm.attachments,{id:item.id}));}},item.id);})})]}),cardForm.checklists&&cardForm.checklists.map(function(checklist,index){return/*#__PURE__*/_jsx(CardChecklist,{checklist:checklist,index:index,onCheckListChange:function onCheckListChange(item,itemIndex){setValue('checklists',_.setIn(cardForm.checklists,\"[\".concat(itemIndex,\"]\"),item));},onRemoveCheckList:function onRemoveCheckList(){setValue('checklists',_.reject(cardForm.checklists,{id:checklist.id}));}},checklist.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-24\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-16 mb-12\",children:[/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:chat-alt\"}),/*#__PURE__*/_jsx(Typography,{className:\"font-semibold text-16 mx-8\",children:\"Comment\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CardComment,{onCommentAdd:function onCommentAdd(comment){return setValue('activities',[comment].concat(_toConsumableArray(cardForm.activities)));}})})]}),/*#__PURE__*/_jsx(Controller,{name:\"activities\",control:control,defaultValue:[],render:function render(_ref3){var _ref3$field=_ref3.field,onChange=_ref3$field.onChange,value=_ref3$field.value;return/*#__PURE__*/_jsx(\"div\",{children:value.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-24\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-16\",children:[/*#__PURE__*/_jsx(FuseSvgIcon,{size:20,children:\"heroicons-outline:clipboard-list\"}),/*#__PURE__*/_jsx(Typography,{className:\"font-semibold text-16 mx-8\",children:\"Activity\"})]}),/*#__PURE__*/_jsx(List,{className:\"\",children:value.map(function(item){return/*#__PURE__*/_jsx(CardActivity,{item:item},item.id);})})]})});}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex order-first sm:order-last items-start sticky top-0\",children:/*#__PURE__*/_jsxs(Box,{className:\"flex flex-row sm:flex-col items-center sm:py-8 rounded-12 w-full\",sx:{backgroundColor:'background.default'},children:[/*#__PURE__*/_jsx(IconButton,{className:\"order-last sm:order-first\",color:\"inherit\",onClick:function onClick(ev){return dispatch(closeCardDialog());},size:\"large\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{children:\"heroicons-outline:x\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row items-center sm:items-start sm:flex-col flex-1\",children:[/*#__PURE__*/_jsx(Controller,{name:\"dueDate\",control:control,defaultValue:null,render:function render(_ref4){var _ref4$field=_ref4.field,onChange=_ref4$field.onChange,value=_ref4$field.value;return/*#__PURE__*/_jsx(DueMenu,{onDueChange:onChange,onRemoveDue:function onRemoveDue(){return onChange(null);},dueDate:value});}}),/*#__PURE__*/_jsx(Controller,{name:\"labels\",control:control,defaultValue:[],render:function render(_ref5){var _ref5$field=_ref5.field,onChange=_ref5$field.onChange,value=_ref5$field.value;return/*#__PURE__*/_jsx(LabelsMenu,{onToggleLabel:function onToggleLabel(labelId){return onChange(_.xor(value,[labelId]));},labels:value});}}),/*#__PURE__*/_jsx(Controller,{name:\"memberIds\",control:control,defaultValue:[],render:function render(_ref6){var _ref6$field=_ref6.field,onChange=_ref6$field.onChange,value=_ref6$field.value;return/*#__PURE__*/_jsx(MembersMenu,{onToggleMember:function onToggleMember(memberId){return onChange(_.xor(value,[memberId]));},memberIds:value});}}),/*#__PURE__*/_jsx(Controller,{name:\"attachments\",control:control,defaultValue:[],render:function render(_ref7){var _ref7$field=_ref7.field,onChange=_ref7$field.onChange,value=_ref7$field.value;return/*#__PURE__*/_jsx(IconButton,{size:\"large\",children:/*#__PURE__*/_jsx(FuseSvgIcon,{children:\"heroicons-outline:paper-clip\"})});}}),/*#__PURE__*/_jsx(Controller,{name:\"checklists\",control:control,defaultValue:[],render:function render(_ref8){var _ref8$field=_ref8.field,onChange=_ref8$field.onChange,value=_ref8$field.value;return/*#__PURE__*/_jsx(CheckListMenu,{onAddCheckList:function onAddCheckList(newList){return onChange([].concat(_toConsumableArray(cardForm.checklists),[newList]));}});}}),/*#__PURE__*/_jsx(OptionsMenu,{onRemoveCard:function onRemoveCard(){return dispatch(removeCard());}})]})]})})]})});}export default BoardCardForm;","map":null,"metadata":{},"sourceType":"module"}