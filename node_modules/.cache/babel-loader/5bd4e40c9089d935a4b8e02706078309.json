{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RemoveUnusedComponents = void 0;\n\nconst utils_1 = require(\"../../utils\");\n\nconst RemoveUnusedComponents = () => {\n  let components = new Map();\n\n  function registerComponent(location, componentType, name) {\n    var _a;\n\n    components.set(location.absolutePointer, {\n      used: ((_a = components.get(location.absolutePointer)) === null || _a === void 0 ? void 0 : _a.used) || false,\n      componentType,\n      name\n    });\n  }\n\n  return {\n    ref: {\n      leave(ref, _ref) {\n        let {\n          type,\n          resolve,\n          key\n        } = _ref;\n\n        if (['Schema', 'Parameter', 'Response', 'SecurityScheme'].includes(type.name)) {\n          const resolvedRef = resolve(ref);\n          if (!resolvedRef.location) return;\n          components.set(resolvedRef.location.absolutePointer, {\n            used: true,\n            name: key.toString()\n          });\n        }\n      }\n\n    },\n    DefinitionRoot: {\n      leave(root, ctx) {\n        const data = ctx.getVisitorData();\n        data.removedCount = 0;\n        let rootComponents = new Set();\n        components.forEach(usageInfo => {\n          const {\n            used,\n            name,\n            componentType\n          } = usageInfo;\n\n          if (!used && componentType) {\n            rootComponents.add(componentType);\n            delete root[componentType][name];\n            data.removedCount++;\n          }\n        });\n\n        for (const component of rootComponents) {\n          if (utils_1.isEmptyObject(root[component])) {\n            delete root[component];\n          }\n        }\n      }\n\n    },\n    NamedSchemas: {\n      Schema(schema, _ref2) {\n        let {\n          location,\n          key\n        } = _ref2;\n\n        if (!schema.allOf) {\n          registerComponent(location, 'definitions', key.toString());\n        }\n      }\n\n    },\n    NamedParameters: {\n      Parameter(_parameter, _ref3) {\n        let {\n          location,\n          key\n        } = _ref3;\n        registerComponent(location, 'parameters', key.toString());\n      }\n\n    },\n    NamedResponses: {\n      Response(_response, _ref4) {\n        let {\n          location,\n          key\n        } = _ref4;\n        registerComponent(location, 'responses', key.toString());\n      }\n\n    },\n    NamedSecuritySchemes: {\n      SecurityScheme(_securityScheme, _ref5) {\n        let {\n          location,\n          key\n        } = _ref5;\n        registerComponent(location, 'securityDefinitions', key.toString());\n      }\n\n    }\n  };\n};\n\nexports.RemoveUnusedComponents = RemoveUnusedComponents;","map":{"version":3,"names":["Object","defineProperty","exports","value","RemoveUnusedComponents","utils_1","require","components","Map","registerComponent","location","componentType","name","_a","set","absolutePointer","used","get","ref","leave","type","resolve","key","includes","resolvedRef","toString","DefinitionRoot","root","ctx","data","getVisitorData","removedCount","rootComponents","Set","forEach","usageInfo","add","component","isEmptyObject","NamedSchemas","Schema","schema","allOf","NamedParameters","Parameter","_parameter","NamedResponses","Response","_response","NamedSecuritySchemes","SecurityScheme","_securityScheme"],"sources":["C:/Users/giato/Downloads/Workspace/.Net/api/doctor-management-fe/node_modules/@redocly/openapi-core/lib/rules/oas2/remove-unused-components.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RemoveUnusedComponents = void 0;\nconst utils_1 = require(\"../../utils\");\nconst RemoveUnusedComponents = () => {\n    let components = new Map();\n    function registerComponent(location, componentType, name) {\n        var _a;\n        components.set(location.absolutePointer, {\n            used: ((_a = components.get(location.absolutePointer)) === null || _a === void 0 ? void 0 : _a.used) || false,\n            componentType,\n            name,\n        });\n    }\n    return {\n        ref: {\n            leave(ref, { type, resolve, key }) {\n                if (['Schema', 'Parameter', 'Response', 'SecurityScheme'].includes(type.name)) {\n                    const resolvedRef = resolve(ref);\n                    if (!resolvedRef.location)\n                        return;\n                    components.set(resolvedRef.location.absolutePointer, {\n                        used: true,\n                        name: key.toString(),\n                    });\n                }\n            }\n        },\n        DefinitionRoot: {\n            leave(root, ctx) {\n                const data = ctx.getVisitorData();\n                data.removedCount = 0;\n                let rootComponents = new Set();\n                components.forEach(usageInfo => {\n                    const { used, name, componentType } = usageInfo;\n                    if (!used && componentType) {\n                        rootComponents.add(componentType);\n                        delete root[componentType][name];\n                        data.removedCount++;\n                    }\n                });\n                for (const component of rootComponents) {\n                    if (utils_1.isEmptyObject(root[component])) {\n                        delete root[component];\n                    }\n                }\n            },\n        },\n        NamedSchemas: {\n            Schema(schema, { location, key }) {\n                if (!schema.allOf) {\n                    registerComponent(location, 'definitions', key.toString());\n                }\n            },\n        },\n        NamedParameters: {\n            Parameter(_parameter, { location, key }) {\n                registerComponent(location, 'parameters', key.toString());\n            },\n        },\n        NamedResponses: {\n            Response(_response, { location, key }) {\n                registerComponent(location, 'responses', key.toString());\n            },\n        },\n        NamedSecuritySchemes: {\n            SecurityScheme(_securityScheme, { location, key }) {\n                registerComponent(location, 'securityDefinitions', key.toString());\n            },\n        }\n    };\n};\nexports.RemoveUnusedComponents = RemoveUnusedComponents;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}